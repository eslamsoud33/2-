<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الكنز - اختبار الجغرافيا</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Google Fonts: Cairo -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #f0f9ff;
        }
        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 8vw;
            color: rgba(37, 99, 235, 0.05);
            font-weight: 800;
            pointer-events: none;
            z-index: 0;
            white-space: nowrap;
            user-select: none;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #93c5fd;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #60a5fa;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        .animate-scale-in {
            animation: scaleIn 0.3s ease-out forwards;
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 900: '#1e3a8a',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="text-gray-800 h-screen overflow-hidden relative">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icon Components ---
        const IconFullscreen = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3"/><path d="M16 3h3a2 2 0 0 1 2 2v3"/><path d="M8 21H5a2 2 0 0 1-2-2v-3"/><path d="M16 21h3a2 2 0 0 0 2-2v-3"/></svg>
        );
        const IconCheck = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        );
        const IconX = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        );
        const IconAward = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
        );
        const IconArrowLeft = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
        );
        const IconHome = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        );
        const IconInfo = () => (
             <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
        );
        const IconRefresh = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 21h5v-5"/></svg>
        );
        const IconEye = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
        );

        // --- Data: 40 Questions ---
        const quizData = [
          {
            id: 1,
            question: "تمثل قارة أوروبا امتداداً طبيعياً لقارة آسيا من جهة الغرب، مما أدى إلى ظهور مصطلح جغرافي يُعرف بـ:",
            options: ["الأورو-متوسطي", "أوراسيا", "الأفرو-آسيوي", "العالم القديم"],
            correctAnswer: "أوراسيا",
            rationale: "مصطلح يدمج اسمي القارتين (أوروبا وآسيا) نظراً لاتصالهما اليابس."
          },
          {
            id: 2,
            question: "أي من الظواهر التضاريسية الآتية تفصل بين قارتي آسيا وأوروبا بشكل طبيعي؟",
            options: ["جبال الهيمالايا", "جبال الألب", "جبال أورال", "جبال البرانس"],
            correctAnswer: "جبال أورال",
            rationale: "سلسلة جبلية تمتد من الشمال للجنوب وتعتبر الحد الفاصل الجغرافي بين القارتين."
          },
          {
            id: 3,
            question: "تتشابه قارة آسيا مع قارة أوروبا في إشرافهما على:",
            options: ["المحيط الهندي", "المحيط القطبي الشمالي", "المحيط الهادي", "البحر الأحمر"],
            correctAnswer: "المحيط القطبي الشمالي",
            rationale: "مسطح مائي يقع في أقصى شمال الكرة الأرضية ويطل عليه الساحل الشمالي للقارتين."
          },
          {
            id: 4,
            question: "تُعرف هضبة التبت بلقب «سقف العالم»؛ وذلك بسبب:",
            options: ["مساحتها الواسعة جداً", "ارتفاعها عن قمم الجبال المجاورة", "استوائها التام", "وقوعها في وسط القارة"],
            correctAnswer: "ارتفاعها عن قمم الجبال المجاورة",
            rationale: "ارتفاعها الشاهق الذي يتجاوز بعض القمم الجبلية جعلها تستحق هذا اللقب."
          },
          {
            id: 5,
            question: "يصب نهر «الفولجا»، الذي يُعد أطول أنهار أوروبا، في:",
            options: ["بحر قزوين", "البحر الأسود", "بحر الشمال", "البحر البلطي"],
            correctAnswer: "بحر قزوين",
            rationale: "أطول أنهار أوروبا يصب في أكبر بحر مغلق في العالم (بحر قزوين)."
          },
          {
            id: 6,
            question: "تفقد أنهار «أوب وينسي ولينا» في شمال آسيا أهميتها الاقتصادية في فصل الشتاء نتيجة:",
            options: ["شدة انحدارها", "قلة كمية المياه", "تجمد مياهها", "كثرة الفيضانات"],
            correctAnswer: "تجمد مياهها",
            rationale: "بسبب الوقوع في المنطقة القطبية، تتجمد المياه فتتوقف الملاحة."
          },
          {
            id: 7,
            question: "أي من المضايق التالية يربط بين قارة آسيا وقارة أمريكا الشمالية؟",
            options: ["مضيق البوسفور", "مضيق هرمز", "مضيق بيرنج", "مضيق باب المندب"],
            correctAnswer: "مضيق بيرنج",
            rationale: "يقترب اليابس الآسيوي من الأمريكي عند هذا المضيق."
          },
          {
            id: 8,
            question: "«رغم وعورتها وارتفاعها، لم تكن جبال الألب حاجزاً أمام تحركات الإنسان». يرجع السبب في ذلك إلى:",
            options: ["وجود الممرات الجبلية", "قلة ارتفاعها النسبي", "ذوبان الجليد صيفاً", "انعدام السكان فيها"],
            correctAnswer: "وجود الممرات الجبلية",
            rationale: "الممرات الطبيعية والأنفاق سهلت الانتقال عبر الجبال."
          },
          {
            id: 9,
            question: "تتميز سواحل قارة أوروبا بكثرة التعاريج، مما أدى مباشرة إلى:",
            options: ["صعوبة الاتصال بالعالم الخارجي", "قيام المواني الطبيعية", "قلة الثروة السمكية", "استقامة الساحل"],
            correctAnswer: "قيام المواني الطبيعية",
            rationale: "التعاريج توفر حماية للسفن مما يشجع على إنشاء المواني."
          },
          {
            id: 10,
            question: "كل مما يلي من هضاب قارة آسيا ما عدا:",
            options: ["هضبة التبت", "هضبة الدكن", "هضبة شبه الجزيرة العربية", "هضبة الميزيتا"],
            correctAnswer: "هضبة الميزيتا",
            rationale: "تقع هضبة الميزيتا في دولة إسبانيا بقارة أوروبا."
          },
          {
            id: 11,
            question: "تتصدر دولة «الصين» دول قارة آسيا في إنتاج العديد من المعادن، أهمها:",
            options: ["الحديد والفحم", "البترول والغاز الطبيعي", "النحاس والبوكسيت فقط", "اليورانيوم والذهب"],
            correctAnswer: "الحديد والفحم",
            rationale: "الصين أكبر منتج للفحم والحديد عالمياً وآسيوياً."
          },
          {
            id: 12,
            question: "يُعد الخام الرئيسي لمعدن الألومنيوم، وتنتج قارة آسيا نحو خمسي إنتاجه العالمي:",
            options: ["المنجنيز", "البوكسيت", "النحاس", "الكروم"],
            correctAnswer: "البوكسيت",
            rationale: "البوكسيت هو الخام الأولي لصناعة الألومنيوم."
          },
          {
            id: 13,
            question: "تعتمد صناعة الأسلاك والأدوات الكهربائية بشكل أساسي على معدن:",
            options: ["الحديد", "النحاس", "الفوسفات", "الرصاص"],
            correctAnswer: "النحاس",
            rationale: "معدن لونه أحمر ويتميز بتوصيله الجيد للكهرباء."
          },
          {
            id: 14,
            question: "يُصنف «الفحم» كأحد مصادر الطاقة:",
            options: ["المتجددة والنظيفة", "الأحفورية الملوثة للبيئة", "الذرية الخطرة", "السائلة سهلة النقل"],
            correctAnswer: "الأحفورية الملوثة للبيئة",
            rationale: "ينتج عن حرقه انبعاثات كربونية عالية."
          },
          {
            id: 15,
            question: "تأتي دولة «السعودية» في المركز الأول بقارة آسيا في إنتاج:",
            options: ["الفحم", "الغاز الطبيعي", "البترول", "الطاقة الكهرومائية"],
            correctAnswer: "البترول",
            rationale: "السعودية هي أكبر منتج ومصدر للبترول."
          },
          {
            id: 16,
            question: "أي من العبارات الآتية تُعد سبباً رئيسياً لزيادة التوجه العالمي نحو استخدام «الغاز الطبيعي» بديلاً للبترول؟",
            options: ["صعوبة نقله وتخزينه", "أنه أقل تلويثاً للبيئة ورخيص الثمن", "أنه مصدر طاقة متجدد", "دخوله في صناعة الألومنيوم"],
            correctAnswer: "أنه أقل تلويثاً للبيئة ورخيص الثمن",
            rationale: "مقارنة بالفحم والبترول، الغاز أنظف وأقل تكلفة."
          },
          {
            id: 17,
            question: "«المواد الخام الحرجة» مصطلح يطلق على المعادن التي:",
            options: ["تتوفر بكميات ضخمة جداً", "ليس لها قيمة اقتصادية", "محدودة الوجود ولها أهمية استراتيجية", "تستخدم فقط في البناء"],
            correctAnswer: "محدودة الوجود ولها أهمية استراتيجية",
            rationale: "مثل النيكل والليثيوم المستخدمة في التكنولوجيا الحديثة."
          },
          {
            id: 18,
            question: "تنتشر «الغابات المدارية المطيرة» في قارة آسيا في:",
            options: ["جزر إندونيسيا والساحل الغربي للهند", "وسط القارة وشبه الجزيرة العربية", "سهول سيبيريا", "شمال اليابان"],
            correctAnswer: "جزر إندونيسيا والساحل الغربي للهند",
            rationale: "مناطق قريبة من خط الاستواء تتميز بالحرارة والمطر طوال العام."
          },
          {
            id: 19,
            question: "تنمو «الغابات الموسمية» في المناطق التي تتميز مناخياً بـ:",
            options: ["أمطار طوال العام", "صيف غزير المطر وشتاء جاف", "نادر المطر شديد الحرارة", "شتاء ممطر وصيف جاف"],
            correctAnswer: "صيف غزير المطر وشتاء جاف",
            rationale: "بسبب الرياح الموسمية الصيفية الممطرة والشتوية الجافة."
          },
          {
            id: 20,
            question: "أهم الأشجار التي تنمو في الغابات النفضية وتستخدم أخشابها في صناعة الأثاث:",
            options: ["الماهوجني", "الزان", "الصنوبر", "المطاط"],
            correctAnswer: "الزان",
            rationale: "شجر نفضي خشبُه صلب ويصلح للأثاث."
          },
          {
            id: 21,
            question: "تنفض الغابات النفضية أوراقها في فصلي الخريف والشتاء بسبب:",
            options: ["شدة الرياح", "شدة البرودة", "قلة خصوبة التربة", "كثرة الأمطار"],
            correctAnswer: "شدة البرودة",
            rationale: "آلية تكيف للحفاظ على المياه وحماية الشجرة من التجمد."
          },
          {
            id: 22,
            question: "أي من الكائنات الآتية يعيش في «الغابات المخروطية» (الصنوبرية)؟",
            options: ["الزواحف الضخمة", "الدب القطبي والثعلب القطبي", "الأسود والنمور", "القردة"],
            correctAnswer: "الدب القطبي والثعلب القطبي",
            rationale: "حيوانات ذات فراء كثيف لتتحمل البرودة."
          },
          {
            id: 23,
            question: "تختلف حشائش السافانا في آسيا عن إفريقيا في أنها:",
            options: ["أقل طولاً وكثافة", "أكثر طولاً وكثافة بسبب غزارة الأمطار", "خالية من الحيوانات", "تنمو في فصل الشتاء"],
            correctAnswer: "أكثر طولاً وكثافة بسبب غزارة الأمطار",
            rationale: "كمية الأمطار في آسيا أكبر مما يجعل السافانا تشبه الغابات."
          },
          {
            id: 24,
            question: "تعتبر حشائش «الاستبس» مراعي طبيعية وتعرف في أمريكا الشمالية باسم:",
            options: ["السافانا", "البراري", "التندرا", "التايجا"],
            correctAnswer: "البراري",
            rationale: "الاسم المحلي لحشائش الاستبس في أمريكا الشمالية."
          },
          {
            id: 25,
            question: "تخلو قارة أوروبا من «الصحاري الحارة»؛ بسبب:",
            options: ["وقوعها في المنطقة الباردة والمعتدلة", "كثرة الغابات", "صغر مساحتها", "إحاطة المياه بها من جميع الجهات"],
            correctAnswer: "وقوعها في المنطقة الباردة والمعتدلة",
            rationale: "موقع أوروبا الفلكي شمال مدار السرطان يجعلها بعيدة عن النطاق الحار."
          },
          {
            id: 26,
            question: "تنمو في «الصحاري الباردة» (التندرا) نباتات عبارة عن:",
            options: ["أشجار ضخمة", "طحالب وحشائش سريعة النمو", "نخيل وصبار", "حشائش طويلة (سافانا)"],
            correctAnswer: "طحالب وحشائش سريعة النمو",
            rationale: "تنمو خلال فصل ذوبان الجليد القصير."
          },
          {
            id: 27,
            question: "أي من الأنهار الآتية يُعد «مركزاً للتنوع البيولوجي» في أوروبا ويمر بعدة عواصم؟",
            options: ["نهر السين", "نهر الدانوب", "نهر التايمز", "نهر الفولجا"],
            correctAnswer: "نهر الدانوب",
            rationale: "يخترق وسط أوروبا ويمر بعدة دول ويتميز بمحميات طبيعية في دلتاه."
          },
          {
            id: 28,
            question: "توجد «الشعاب المرجانية» في سواحل جنوب شرق آسيا وتغيب عن سواحل أوروبا بسبب:",
            options: ["عمق المياه في أوروبا", "انخفاض حرارة مياه أوروبا", "شدة ملوحة البحر المتوسط", "التلوث الصناعي فقط"],
            correctAnswer: "انخفاض حرارة مياه أوروبا",
            rationale: "المرجان يحتاج مياه دافئة (مدارية) وهو ما تفتقده أوروبا."
          },
          {
            id: 29,
            question: "تختفي أشجار «المانجروف» تماماً من قارة أوروبا لعدم توافر:",
            options: ["التربة الطينية", "الظروف المناخية المدارية", "المياه المالحة", "الأيدي العاملة"],
            correctAnswer: "الظروف المناخية المدارية",
            rationale: "المانجروف نبات مداري ينمو في المياه الضحلة الحارة، وأوروبا باردة/معتدلة."
          },
          {
            id: 30,
            question: "تتعرض الأنهار في آسيا وأوروبا لتهديدات بشرية عديدة، أبرزها:",
            options: ["الفيضانات الطبيعية", "بناء السدود والتلوث الصناعي", "تجمد المياه", "كثرة الأمطار"],
            correctAnswer: "بناء السدود والتلوث الصناعي",
            rationale: "أنشطة بشرية تغير بيئة النهر وتقتل الحياة فيه."
          },
          {
            id: 31,
            question: "تتميز بحيرة «بيكال» في آسيا بأنها:",
            options: ["أكثر البحيرات ملوحة", "أعمق بحيرة عذبة في العالم", "ضحلة وتجف صيفاً", "تقع في المنطقة الاستوائية"],
            correctAnswer: "أعمق بحيرة عذبة في العالم",
            rationale: "تحتوي على مخزون ضخم من المياه العذبة وتعرف بلؤلؤة سيبيريا."
          },
          {
            id: 32,
            question: "العامل المشترك بين «اليابان» و«بريطانيا» جغرافياً هو أن كليهما:",
            options: ["دول حبيسة", "دول جزرية", "تقعان في المنطقة الحارة", "تتبعان قارة آسيا"],
            correctAnswer: "دول جزرية",
            rationale: "عبارة عن جزر في المحيط (اليابان في الهادي، بريطانيا في الأطلنطي)."
          },
          {
            id: 33,
            question: "أي من الدول الآتية يمر بها «مدار السرطان»؟",
            options: ["روسيا", "الهند", "فرنسا", "منغوليا"],
            correctAnswer: "الهند",
            rationale: "يمر مدار السرطان في وسط الهند."
          },
          {
            id: 34,
            question: "أطلقت أوروبا مبادرات «الاتفاق الأخضر» بهدف رئيسي هو:",
            options: ["زيادة إنتاج الفحم", "استعادة التنوع البيولوجي وخفض الكربون", "توسيع الرقعة العمرانية", "تغطية الأنهار"],
            correctAnswer: "استعادة التنوع البيولوجي وخفض الكربون",
            rationale: "مبادرة بيئية لتحقيق الاستدامة ومواجهة التغير المناخي."
          },
          {
            id: 35,
            question: "كل مما يأتي صحيح عن «جبال الهيمالايا» ما عدا أنها:",
            options: ["تقع في قارة آسيا", "بها أعلى قمة في العالم", "تمتد في قارة أوروبا", "سلاسل جبلية ضخمة"],
            correctAnswer: "تمتد في قارة أوروبا",
            rationale: "خطأ، فهي في آسيا فقط."
          },
          {
            id: 36,
            question: "«دلتا نهر الدانوب» تعد منطقة هامة لأنها:",
            options: ["منطقة صحراوية جافة", "محمية للتنوع البيولوجي والأراضي الرطبة", "مركز للصناعات الثقيلة", "خالية من السكان"],
            correctAnswer: "محمية للتنوع البيولوجي والأراضي الرطبة",
            rationale: "تعتبر من أهم الأراضي الرطبة في أوروبا."
          },
          {
            id: 37,
            question: "تتعرض سواحل آسيا الشرقية والجنوبية لأعاصير مدارية مدمرة تُعرف باسم:",
            options: ["التسونامي", "التيفون", "الخماسين", "الهاري كين"],
            correctAnswer: "التيفون",
            rationale: "الاسم المحلي للأعاصير المدارية في المحيط الهادي وشرق آسيا."
          },
          {
            id: 38,
            question: "يتركز السكان في السهل الأوروبي العظيم بسبب:",
            options: ["وعورة السطح", "خصوبة التربة وقيام الزراعة", "انتشار الغابات الكثيفة", "الجو شديد البرودة"],
            correctAnswer: "خصوبة التربة وقيام الزراعة",
            rationale: "سهول فيضية غنية ورواسب طينية ساعدت على الاستيطان."
          },
          {
            id: 39,
            question: "أي من الدول الأوروبية التالية تشتهر بإنتاج طاقة الرياح؟",
            options: ["ألمانيا", "اليونان", "أوكرانيا", "إيطاليا"],
            correctAnswer: "ألمانيا",
            rationale: "تحتل المركز الأول أوروبياً في إنتاج طاقة الرياح."
          },
          {
            id: 40,
            question: "العامل الرئيسي في اختلاف النبات الطبيعي بين جنوب آسيا وشمالها هو:",
            options: ["اختلاف التربة فقط", "التنوع المناخي (الحرارة والأمطار)", "النشاط البشري", "القرب من البحر"],
            correctAnswer: "التنوع المناخي (الحرارة والأمطار)",
            rationale: "التدرج في المناخ من الاستوائي جنوباً إلى القطبي شمالاً يؤدي لتنوع النبات."
          }
        ];

        // --- Components ---

        const Home = ({ onStart, studentName, setStudentName }) => {
            return (
                <div className="flex flex-col items-center justify-center min-h-[80vh] w-full p-4 animate-fade-in">
                    <div className="glass-panel p-8 rounded-2xl shadow-xl border border-primary-100 max-w-md w-full text-center relative z-10">
                        <div className="mb-6 flex justify-center">
                            <div className="p-4 bg-primary-100 rounded-full text-primary-600">
                                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m2 4 3 12h14l3-12-6 7-4-3-4 3-6-7z"/><circle cx="12" cy="19" r="2"/></svg>
                            </div>
                        </div>
                        <h1 className="text-4xl font-bold text-primary-900 mb-2">الكنز</h1>
                        
                        <div className="mb-8 flex flex-col items-center">
                            <span className="text-gray-500 font-medium text-sm mb-1">إعداد</span>
                            <span className="text-3xl font-extrabold text-primary-700">أ / إسلام سعود</span>
                        </div>
                        
                        <div className="space-y-4">
                            <div className="text-right">
                                <label className="block text-sm font-medium text-gray-700 mb-1 mr-1">المادة</label>
                                <div className="w-full p-3 bg-gray-50 rounded-lg border border-gray-200 text-gray-600 font-semibold">
                                    الجغرافيا - الصف الثاني الإعدادي
                                </div>
                            </div>
                            
                            <div className="text-right">
                                <label className="block text-sm font-medium text-gray-700 mb-1 mr-1">اسم الطالب رباعي</label>
                                <input 
                                    type="text" 
                                    value={studentName}
                                    onChange={(e) => setStudentName(e.target.value)}
                                    placeholder="اكتب اسمك هنا..."
                                    className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-primary-500 focus:ring focus:ring-primary-100 focus:outline-none transition-all"
                                />
                            </div>

                            <button 
                                onClick={onStart}
                                disabled={!studentName.trim()}
                                className={`w-full py-3 px-6 rounded-xl font-bold text-lg shadow-lg transform transition-all duration-200 flex items-center justify-center gap-2
                                    ${studentName.trim() 
                                        ? 'bg-primary-600 text-white hover:bg-primary-700 hover:-translate-y-1' 
                                        : 'bg-gray-200 text-gray-400 cursor-not-allowed'}`}
                            >
                                ابدأ الاختبار
                                <IconArrowLeft />
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const Quiz = ({ question, currentQuestionIndex, totalQuestions, onAnswer }) => {
            const progress = ((currentQuestionIndex + 1) / totalQuestions) * 100;
            const [selectedOption, setSelectedOption] = useState(null);
            const [isConfirmed, setIsConfirmed] = useState(false);
            const isLastQuestion = currentQuestionIndex === totalQuestions - 1;
            const bottomRef = useRef(null);

            useEffect(() => {
                setSelectedOption(null);
                setIsConfirmed(false);
            }, [currentQuestionIndex]);

            const handleOptionClick = (option) => {
                if (!isConfirmed) {
                    setSelectedOption(option);
                    setIsConfirmed(true); // Lock choice immediately
                }
            };

            useEffect(() => {
                if (isConfirmed && bottomRef.current) {
                    setTimeout(() => {
                        bottomRef.current.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }, 100);
                }
            }, [isConfirmed]);

            const handleMainButtonClick = () => {
                // Since confirmation is instant, this button is purely for navigation
                onAnswer(selectedOption);
            };
            
            const getOptionStyle = (option) => {
                let baseStyle = "p-4 rounded-xl text-right border-2 font-medium transition-all duration-200 flex items-center justify-between group ";
                
                if (!isConfirmed) {
                    return baseStyle + "border-gray-200 bg-white hover:border-primary-300 hover:bg-gray-50 text-gray-700";
                } else {
                    // Confirmed state
                    if (option === question.correctAnswer) {
                        return baseStyle + "border-green-500 bg-green-100 text-green-800 shadow-md"; 
                    } else if (selectedOption === option && option !== question.correctAnswer) {
                        return baseStyle + "border-red-500 bg-red-100 text-red-800 shadow-md"; 
                    } else {
                        return baseStyle + "border-gray-200 bg-gray-50 text-gray-400 opacity-60"; 
                    }
                }
            };

            const getOptionIcon = (option) => {
                if (!isConfirmed) {
                     return (
                         <div className={`w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-primary-400`}></div>
                     );
                } else {
                     if (option === question.correctAnswer) {
                         return <div className="text-green-600"><IconCheck /></div>;
                     } else if (selectedOption === option) {
                         return <div className="text-red-500"><IconX /></div>;
                     } else {
                         return <div className="w-6 h-6 rounded-full border-2 border-gray-200"></div>;
                     }
                }
            };

            return (
                <div className="flex flex-col items-center min-h-[85vh] w-full max-w-4xl mx-auto p-4 relative z-10">
                    <div className="w-full mb-6">
                        <div className="flex justify-between items-end mb-2 px-1">
                            <span className="text-sm font-bold text-gray-500">سؤال {currentQuestionIndex + 1} من {totalQuestions}</span>
                            <span className="text-sm font-bold text-primary-600">{Math.round(progress)}%</span>
                        </div>
                        <div className="w-full bg-white rounded-full h-3 shadow-inner">
                            <div 
                                className="bg-primary-600 h-3 rounded-full transition-all duration-500 ease-out" 
                                style={{ width: `${progress}%` }}
                            ></div>
                        </div>
                    </div>

                    <div className="glass-panel w-full rounded-2xl shadow-xl border border-white p-6 md:p-10 flex-grow flex flex-col transition-all duration-300">
                        <h2 className="text-xl md:text-2xl font-bold text-gray-800 mb-8 leading-relaxed">
                            {question.question}
                        </h2>

                        <div className="grid grid-cols-1 gap-4 mb-8">
                            {question.options.map((option, idx) => (
                                <button 
                                    key={idx}
                                    onClick={() => handleOptionClick(option)}
                                    disabled={isConfirmed}
                                    className={getOptionStyle(option)}
                                >
                                    <span className="flex-grow">{option}</span>
                                    {getOptionIcon(option)}
                                </button>
                            ))}
                        </div>
                        
                        {/* Show Rationale ONLY if Confirmed AND Wrong */}
                        {isConfirmed && selectedOption !== question.correctAnswer && (
                            <div className="mb-6 p-4 bg-red-50 border border-red-200 rounded-xl animate-fade-in">
                                <div className="flex items-start gap-2 text-gray-700">
                                    <div className="mt-1 text-red-600 min-w-[20px]"><IconInfo /></div>
                                    <div>
                                        <span className="font-bold block mb-1 text-red-700">إجابة خاطئة! التفسير:</span>
                                        <p className="text-sm md:text-base leading-relaxed text-gray-700">{question.rationale}</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Show Next Button only after confirmation */}
                        <div ref={bottomRef} className="mt-auto">
                            {isConfirmed && (
                                <div className="flex justify-end animate-fade-in pt-2">
                                    <button 
                                        onClick={handleMainButtonClick}
                                        className={`py-3 px-8 rounded-xl font-bold shadow-lg transition-all flex items-center gap-2
                                            ${isLastQuestion 
                                                ? 'bg-green-600 text-white hover:bg-green-700 hover:scale-105' 
                                                : 'bg-primary-600 text-white hover:bg-primary-700 hover:scale-105'
                                            }`}
                                    >
                                        {isLastQuestion ? 'إنهاء الاختبار' : 'التالي'}
                                        {isLastQuestion ? <IconCheck /> : <IconArrowLeft />}
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const Result = ({ score, totalQuestions, studentName, onRestart, onRetry }) => {
            const percentage = Math.round((score / totalQuestions) * 100);
            
            let message = "";
            let colorClass = "";
            
            if (percentage >= 90) { message = "ممتاز يا بطل!"; colorClass = "text-green-600"; }
            else if (percentage >= 75) { message = "جيد جداً!"; colorClass = "text-blue-600"; }
            else if (percentage >= 50) { message = "جيد، أحسنت!"; colorClass = "text-yellow-600"; }
            else { message = "حاول مرة أخرى!"; colorClass = "text-red-500"; }

            return (
                <div className="flex flex-col items-center justify-center min-h-[80vh] w-full max-w-4xl mx-auto p-4 z-10 relative">
                    <div className="glass-panel w-full rounded-2xl shadow-xl p-8 mb-8 text-center border-t-4 border-primary-500 animate-scale-in">
                        <div className="inline-block p-4 bg-primary-50 rounded-full text-primary-600 mb-4 shadow-sm">
                            <IconAward />
                        </div>
                        <h2 className="text-3xl font-bold text-gray-800 mb-2">نتيجة الاختبار</h2>
                        <h3 className="text-xl text-gray-600 mb-4 font-semibold">الطالب: {studentName}</h3>
                        
                        <div className="flex justify-center items-center gap-4 mb-4">
                            <div className="text-center">
                                <span className="block text-4xl font-extrabold text-primary-700">{score}</span>
                                <span className="text-sm text-gray-500 font-bold">الدرجة</span>
                            </div>
                            <div className="h-12 w-px bg-gray-300"></div>
                            <div className="text-center">
                                <span className={`block text-4xl font-extrabold ${colorClass}`}>{percentage}%</span>
                                <span className="text-sm text-gray-500 font-bold">النسبة</span>
                            </div>
                        </div>
                        
                        <p className={`text-2xl font-bold ${colorClass} animate-bounce`}>{message}</p>
                    </div>

                    <div className="flex flex-col md:flex-row gap-4 mb-10 w-full md:w-auto justify-center px-4">
                        <button 
                            onClick={onRetry}
                            className="w-full md:w-auto py-3 px-8 rounded-xl bg-orange-500 text-white font-bold text-lg shadow-lg hover:bg-orange-600 hover:shadow-xl transition-all flex items-center justify-center gap-2 order-1 md:order-2"
                        >
                            <IconRefresh />
                            حاول مرة أخرى
                        </button>
                        
                        <button 
                            onClick={onRestart}
                            className="w-full md:w-auto py-3 px-8 rounded-xl bg-primary-600 text-white font-bold text-lg shadow-lg hover:bg-primary-700 hover:shadow-xl transition-all flex items-center justify-center gap-2 order-2 md:order-1"
                        >
                            <IconHome />
                            العودة للرئيسية
                        </button>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [gameState, setGameState] = useState('home');
            const [studentName, setStudentName] = useState('');
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [userAnswers, setUserAnswers] = useState([]);
            const [score, setScore] = useState(0);

            const toggleFullscreen = () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => console.log(err));
                } else {
                    document.exitFullscreen();
                }
            };

            const startQuiz = () => {
                setGameState('quiz');
                setCurrentQuestionIndex(0);
                setUserAnswers([]);
                setScore(0);
                window.scrollTo(0, 0);
            };

            const handleAnswer = (selectedOption) => {
                const currentQuestion = quizData[currentQuestionIndex];
                const isCorrect = selectedOption === currentQuestion.correctAnswer;
                
                setUserAnswers(prevAnswers => [
                    ...prevAnswers, 
                    { 
                        question: currentQuestion, 
                        selectedOption, 
                        isCorrect 
                    }
                ]);

                if (isCorrect) setScore(prevScore => prevScore + 1);

                if (currentQuestionIndex < quizData.length - 1) {
                    setCurrentQuestionIndex(prevIndex => prevIndex + 1);
                    window.scrollTo(0, 0);
                } else {
                    setGameState('result');
                    window.scrollTo(0, 0);
                }
            };

            const restartQuiz = () => {
                setGameState('home');
                setStudentName('');
                setUserAnswers([]);
                setScore(0);
            };
            
            const retryQuiz = () => {
                setGameState('quiz');
                setCurrentQuestionIndex(0);
                setUserAnswers([]);
                setScore(0);
                window.scrollTo(0, 0);
            };

            return (
                <div className="min-h-screen relative overflow-y-auto overflow-x-hidden bg-gradient-to-br from-gray-50 to-gray-200">
                    <div className="watermark">أ / إسلام سعود</div>

                    <div className="sticky top-0 z-50 glass-panel shadow-sm px-4 py-3 flex justify-between items-center border-b border-white">
                        <div className="font-bold text-primary-700 flex items-center gap-2">
                            <span className="bg-primary-100 p-1 rounded-lg"><IconAward /></span>
                            <div className="flex flex-col leading-none sm:flex-row sm:items-center sm:gap-2">
                                <span>الكنز</span>
                                <span className="text-base sm:text-lg font-bold text-orange-600">أ/ إسلام سعود</span>
                            </div>
                        </div>
                        <button 
                            onClick={toggleFullscreen} 
                            className="p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors"
                            title="ملء الشاشة"
                        >
                            <IconFullscreen />
                        </button>
                    </div>

                    <main className="w-full flex justify-center py-4">
                        {gameState === 'home' && (
                            <Home 
                                onStart={startQuiz} 
                                studentName={studentName} 
                                setStudentName={setStudentName} 
                            />
                        )}
                        {gameState === 'quiz' && (
                            <Quiz 
                                question={quizData[currentQuestionIndex]}
                                currentQuestionIndex={currentQuestionIndex}
                                totalQuestions={quizData.length}
                                onAnswer={handleAnswer}
                            />
                        )}
                        {gameState === 'result' && (
                            <Result 
                                score={score}
                                totalQuestions={quizData.length}
                                studentName={studentName}
                                onRestart={restartQuiz}
                                onRetry={retryQuiz}
                            />
                        )}
                    </main>
                    
                    <footer className="fixed bottom-0 w-full text-center text-gray-400 text-xs py-2 pointer-events-none z-0 opacity-50">
                        Designed with React & Tailwind
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>